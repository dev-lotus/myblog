<app-navbar></app-navbar>

<section class="container pb-4 rounded ">
  <div class="row p-2 p-md-3 mt-2 text-light rounded bg-main">
    <div class="col-md-12">
      <h1 class="fw-bold"><i class="fa fa-list" aria-hidden="true"></i> Listings</h1>
    </div>
  </div>
  <div class="row ">
    <div class="bg-light p-3">
      <ul class="nav nav-pills" id="pills-tab" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="pills-home-tab" data-bs-toggle="pill" data-bs-target="#pills-home"
            type="button" role="tab" aria-controls="pills-home" aria-selected="true"><i class="fa fa-gift"
              aria-hidden="true"></i> Free <span class="badge bg-danger">{{freeListing.length}}</span>
            
            </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="pills-profile-tab" data-bs-toggle="pill" data-bs-target="#pills-profile"
            type="button" role="tab" aria-controls="pills-profile" aria-selected="false"><i class="fa fa-handshake-o"
              aria-hidden="true"></i> Borrow <span class="badge bg-danger">{{freeBorrow.length}}</span></button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="pills-contact-tab" data-bs-toggle="pill" data-bs-target="#pills-contact"
            type="button" role="tab" aria-controls="pills-contact" aria-selected="false"><i class="fa fa-bullhorn"
              aria-hidden="true"></i> Wanted</button>
        </li>
      </ul>
    </div>

    <div class="tab-content mt-2" id="pills-tabContent">
      <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
        <div class="row row-cols-md-3 row-cols-1  g-4">
          <div class="col" *ngFor="let list of freeListing; let ind = index">
            <div class="card">
              <a href="listing-details/{{list._id}}/?token={{list.userToken}}&type=listing" class="link-direct">

                <img src="{{list.picture[0]}}" class="card-img-top" alt="...">
                <div class="card-body">
                  <!-- <p class="card-text " *ngIf="this.user[ind+1]._id == list.userToken"><span>
                    <img src="{{this.user[ind+1].profilePicture}}"
                        width="40" className="rounded-circle" /> </span> {{this.user[ind+1].firstName}} {{this.user[ind+1].lastName}}</p> -->

                  <div class="d-flex justify-content-between ">
                    <div>
                      <span class="badge bg-warning text-dark " *ngIf="list.onHold == true; else onHoldStatus">On Hold</span>
                      <ng-template #onHoldStatus>
                        <span class="badge bg-success">Available</span>
    
                      </ng-template>
                      <h5 class="card-title fw-bold mt-2">{{list.title}}</h5>
    
                    </div>
                    <div *ngIf="list.userToken == this.userToken" class="my-auto">
                     <a href="free/edit-listing/{{list._id}}">
                      <img src="https://img.icons8.com/external-kiranshastry-solid-kiranshastry/344/external-edit-interface-kiranshastry-solid-kiranshastry.png" width="30" alt="">
                     </a>
                    </div>
                  </div>
                 
                  <p>{{ (list.description.length>100)? (list.description | slice:0:130)+'..':(list.description) }}</p>

                </div>
              </a>
              <div class="card-footer d-flex justify-content-around">
                <small class="text-muted"><img src="https://img.icons8.com/fluency/344/order-delivered.png" width="20"
                    alt=""> {{this.haversineDistanceResult[ind]}} KM</small>

                <small class="text-muted">{{ list.updatedAt | date }}</small>
                <small> <img src="https://img.icons8.com/color/344/filled-like.png" width="20" alt="">
                  {{this.countLikesListing[ind]}} Liked</small>
              </div>
            </div>


          </div>

        </div>
      </div>
      <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">
     

        <div class="row row-cols-md-3 row-cols-1  g-4">
          <div class="col" *ngFor="let list of freeBorrow; let ind = index">
            <div class="card">
              <a href="listing-details/{{list._id}}/?token={{list.userToken}}&type=borrow" class="link-direct">

                <img src="{{list.picture[0]}}" class="card-img-top" alt="...">
                <div class="card-body">
                  <!-- <p class="card-text " *ngIf="this.user[ind+1]._id == list.userToken"><span>
                    <img src="{{this.user[ind+1].profilePicture}}"
                        width="40" className="rounded-circle" /> </span> {{this.user[ind+1].firstName}} {{this.user[ind+1].lastName}}</p> -->

                  <div class="d-flex justify-content-between ">
                    <div>
                      <span class="badge bg-warning text-dark " *ngIf="list.onHold == true; else onHoldStatus">On Hold</span>
                      <ng-template #onHoldStatus>
                        <span class="badge bg-success">Available</span>
    
                      </ng-template>
                      <h5 class="card-title fw-bold mt-2">{{list.title}}</h5>
    
                    </div>
                    <div *ngIf="list.userToken == this.userToken" class="my-auto">
                     <a href="free/edit-listing/{{list._id}}">
                      <img src="https://img.icons8.com/external-kiranshastry-solid-kiranshastry/344/external-edit-interface-kiranshastry-solid-kiranshastry.png" width="30" alt="">
                     </a>
                    </div>
                  </div>
                 
                  <p>{{ (list.description.length>100)? (list.description | slice:0:130)+'..':(list.description) }}</p>

                </div>
              </a>
              <div class="card-footer d-flex justify-content-around">
                <small class="text-muted"><img src="https://img.icons8.com/fluency/344/order-delivered.png" width="20"
                    alt=""> {{this.haversineDistanceResultForBorrow[ind]}} KM</small>

                <small class="text-muted">{{ list.updatedAt | date }}</small>
                <small> <img src="https://img.icons8.com/color/344/filled-like.png" width="20" alt="">
                  {{this.countLikesListingForBorrow[ind]}} Liked</small>
              </div>
            </div>


          </div>

        </div>

      </div>
      <div class="tab-pane fade" id="pills-contact" role="tabpanel" aria-labelledby="pills-contact-tab">WANTED
      </div>
    </div>
  </div>

</section>

<div class="icon-bar">
  <a href="free/add-listing" class="free"><i class="fa fa-gift" aria-hidden="true"></i></a>
  <a href="add-borrow" class="borrow"><i class="fa fa-handshake-o" aria-hidden="true"></i></a>
  <a href="add-wanted" class="wanted"><i class="fa fa-bullhorn" aria-hidden="true"></i></a>
</div>
